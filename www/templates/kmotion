Listen ${port}
<VirtualHost *:${port}>

    ServerName kmotion
    ServerAdmin webmaster@localhost
    DocumentRoot ${www_dir}
    Options -Indexes
    
    SSLEngine on
	SSLProtocol all -SSLv2
	SSLCertificateFile  /etc/ssl/certs/kmotion.crt
	SSLCertificateKeyFile /etc/ssl/private/kmotion.key
	
    #UserDir disabled root 
    <Directory />
	    AllowOverride None
		<IfVersion < 2.4>
        	Order Deny,Allow
			Deny from All
	    </IfVersion>
	    <IfVersion >= 2.4>
	        Require all denied
	    </IfVersion>
    </Directory>

    <Directory ${www_dir}>
        # secure login ...
        ${AUTH_block}
	
        AllowOverride None
		<IfVersion < 2.4>
        	Order allow,deny
        	Allow from all
	    </IfVersion>
	    <IfVersion >= 2.4>
	        Require valid-user
	    </IfVersion>
    </Directory>
    
    Alias /archive/ ${archive_dir}/
    <Directory ${archive_dir}/>
        # secure login ...
        ${AUTH_block}
	
        AllowOverride None
		<IfVersion < 2.4>
        	Order allow,deny
        	Allow from all
	    </IfVersion>
	    <IfVersion >= 2.4>
	        Require valid-user
	    </IfVersion>
    </Directory>

    Alias /kmotion_ramdisk/ ${ramdisk_dir}/
    <Directory ${ramdisk_dir}/>
        # secure login ...
        ${AUTH_block}
	
        AllowOverride None
		<IfVersion < 2.4>
        	Order allow,deny
        	Allow from all
	    </IfVersion>
	    <IfVersion >= 2.4>
	        Require valid-user
	    </IfVersion>
    </Directory>
    
    WSGIScriptAlias /ajax ${wsgi_scripts}/ajax.py
    WSGIPassAuthorization On
    WSGIDaemonProcess kmotion processes=2 threads=15 display-name=%{GROUP} lang=ru_RU.UTF-8 locale=ru_RU.UTF-8
    WSGIProcessGroup kmotion
    <Directory ${wsgi_scripts}>
		# secure login ...
		${AUTH_block}
	        
		AllowOverride None
		<IfVersion < 2.4>
        	Order allow,deny
        	Allow from all
	    </IfVersion>
	    <IfVersion >= 2.4>
	        Require valid-user
	    </IfVersion>
    </Directory>

    # Possible values include: debug, info, notice, warn, error, crit,
    LogLevel notice

	ErrorLog "${APACHE_LOG_DIR}/kmotion_error.log"
	TransferLog "${APACHE_LOG_DIR}/kmotion_access.log"
    
</VirtualHost>


